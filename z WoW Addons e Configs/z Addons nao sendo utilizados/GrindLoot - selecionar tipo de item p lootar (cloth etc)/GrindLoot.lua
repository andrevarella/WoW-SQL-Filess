GrindLootPanelOptions = {
	useGrindLoot = { text = "Use GrindLoot" },
	miningLoot = { text = "Loot and destroy rocks from mining results" },
	skinningLoot = { text = "Skinning mode: Loot all and destroy trash." },
	fishingMode1 = { text = "Fishing: Close loot on trash take anything else." },
	fishingMode2 = { text = "Fishing: Loot only highest level fish." },
	minRarity = { text = "Loot only above this threshold", default = "2" },
	clothLevel = { text = "Loot only above this threshold", default = "CLOTH" },
}

GrindLoot_MetalStone = {  [36910]=80,[36912]=80,[2838]=30,[2772]=30, [17771]=60, [18562]=60, [17203]=60, [12360]=55, [23447]=70, [23427]=70, [23448]=60, [3577]=30, [2776]=25, [12809]=60, [35128]=70, [23449]=70, [23426]=70, [2842]=10, [2775]=10, [6037]=50, [7911]=40, [23446]=65, [23425]=65, [2841]=20, [3857]=30, [3478]=20, [2836]=15, [2840]=10, [2770]=10, [11371]=50, [11370]=50, [12644]=45, [12365]=45, [18567]=60, [12655]=55, [23445]=60, [23424]=60, [23573]=65, [22202]=1, [7966]=35, [7912]=35, [3859]=35, [12359]=50, [10620]=40, [3576]=20, [2771]=20, [2835]=1 };
stones = {  [7912]=1, [12365]=1, [2838]=1, [2836]=1, [2835]=1 };
GrindLoot_Cloth = { [21845]=70, [24272]=70, [24271]=70, [21842]=66, [2996]=10, [4339]=45, [21840]=60, [14048]=55, [4305]=35, [21844]=70, [2997]=25, [2320]=5, [14256]=50, [2321]=20, [8343]=40, [14227]=50, [2589]=5, [4338]=40, [14342]=55, [21877]=60, [21881]=60, [14341]=50, [14047]=50, [10285]=40, [4306]=30, [4291]=30, [3182]=20, [4337]=35, [2592]=15 };
GrindLoot_Elementals = { [23571]=65, [7082]=55, [7076]=55, [7078]=55, [12808]=55, [7080]=55, [12803]=55, [22451]=65, [22452]=65, [21884]=65, [21886]=65, [22457]=65, [22456]=65, [21885]=65, [7081]=45, [7075]=45, [7069]=25, [7067]=25, [7068]=25, [7070]=25, [7079]=45, [7077]=45, [10286]=45, [7972]=45, [22572]=65, [22573]=65, [22574]=65, [22575]=65, [22576]=65, [22577]=65, [22578]=65 };
GrindLoot_Enchanting = { [20725]=60, [22450]=70, [14344]=55, [11084]=25, [11139]=35, [22449]=70, [11178]=45, [22463]=61, [14343]=50, [10978]=20, [11138]=30, [22448]=65, [11177]=40, [11082]=25, [16203]=55, [10939]=15, [11135]=35, [11175]=45, [22446]=65, [10998]=20, [16202]=50, [10938]=10, [11134]=30, [11174]=40, [22447]=60, [22462]=61, [25844]=70, [22445]=60, [16206]=55, [6217]=5, [11176]=45, [25845]=75, [25843]=60, [11128]=30, [16204]=55, [16207]=58, [6218]=5, [22461]=61, [11130]=30, [6339]=20, [11145]=40 };
GrindLoot_Herbs = { [19727]=60, [13468]=60, [19726]=60, [22790]=68, [8836]=44, [8839]=47, [22710]=5, [2450]=15, [2453]=20, [13463]=54, [22786]=60, [2449]=5, [3818]=32, [22794]=75, [22785]=60, [4625]=41, [22788]=67, [8845]=47, [13464]=52, [3821]=34, [3369]=24, [8846]=50, [13467]=58, [3358]=37, [3356]=24, [3357]=30, [785]=10, [22793]=75, [13465]=56, [22791]=70, [22797]=73, [22792]=73, [2447]=5, [13466]=57, [8831]=42, [22787]=65, [765]=5, [3820]=20, [8838]=46, [2452]=15, [22789]=60, [3355]=22, [8153]=40 };
GrindLoot_Leather = { [17967]=60, [15410]=60, [20381]=63, [15416]=55, [7286]=1, [15415]=50, [15423]=50, [29539]=60, [17012]=60, [25699]=60, [4236]=30, [4231]=10, [4233]=20, [15407]=50, [8172]=40, [8150]=40, [6470]=1, [15417]=50, [12810]=55, [25707]=70, [25700]=60, [15422]=50, [15412]=50, [7392]=1, [4235]=30, [23793]=65, [4234]=30, [15408]=55, [20501]=55, [15420]=50, [8168]=45, [21887]=60, [25649]=60, [783]=10, [2318]=10, [20500]=55, [5116]=1, [4232]=20, [2319]=20, [29548]=60, [20498]=30, [20498]=55, [5784]=15, [25708]=60, [8169]=40, [4304]=40, [5785]=35, [8368]=40, [5082]=10, [8167]=35, [15419]=50, [29547]=60, [8165]=45 };
GrindLoot_Meat = { [27422]=60, [27669]=5, [35562]=50, [3173]=11, [3730]=21, [33823]=65, [3172]=10, [2677]=14, [27671]=60, [3404]=35, [21024]=60, [27677]=60, [769]=5, [5503]=14, [27678]=60, [2673]=10, [2886]=5, [2675]=13, [2674]=13, [33824]=65, [1081]=15, [2924]=14, [22644]=15, [13888]=55, [27435]=60, [27439]=60, [4655]=35, [12207]=45, [35285]=70, [27438]=60, [2251]=25, [723]=12, [731]=12, [2296]=16, [12204]=35, [27437]=60, [24477]=65, [5467]=10, [1015]=19, [3731]=23, [27668]=5, [12223]=5, [23676]=1, [730]=11, [1468]=16, [12037]=30, [3685]=22, [12184]=30, [31670]=60, [27674]=60, [21071]=35, [21071]=20, [6303]=5, [8959]=55, [4603]=45, [13756]=45, [13760]=45, [13889]=55, [12203]=30, [20424]=55, [5466]=8, [31671]=60, [6889]=5, [5465]=5, [5468]=15, [3174]=10, [27425]=60, [5471]=23, [2665]=1, [27676]=60, [5469]=10, [729]=10, [2672]=5, [27682]=60, [5504]=23, [12206]=40, [3667]=23, [12208]=40, [5470]=22, [12202]=30, [1080]=15, [3712]=30, [27681]=60, [12205]=40, [27429]=60, [7974]=45, [37588]=35 };
GrindLoot_Potions ={ [32947]=65, [32948]=68, [32902]=68, [32905]=65, [5632]=25, [33934]=60, [33935]=62, [22839]=70, [4596]=15, [12190]=45, [31677]=72, [31676]=69, [6049]=33, [5634]=30, [6050]=38, [5633]=35, [13461]=58, [20002]=60, [13457]=58, [13456]=58, [1710]=31, [13460]=58, [6149]=41, [13458]=58, [13459]=58, [22849]=73, [22849]=73, [2633]=32, [858]=13, [3823]=33, [3385]=24, [4623]=43, [3387]=50, [20008]=57, [34440]=75, [9036]=42, [22845]=72, [32840]=72, [22836]=70, [22841]=72, [32846]=72, [22842]=72, [32847]=72, [17348]=55, [13446]=55, [22847]=72, [17351]=55, [13444]=59, [22844]=72, [32844]=72, [18253]=60, [22846]=72, [2455]=22, [2455]=15, [2456]=15, [3087]=15, [6052]=38, [13462]=57, [5631]=14, [9030]=42, [32762]=68, [32763]=65, [6048]=27, [22871]=67, [22826]=63, [3388]=25, [22829]=65, [22832]=68, [22850]=75, [17349]=45, [3928]=45, [17352]=45, [13443]=51, [2459]=15, [6372]=20, [25548]=50, [28101]=62 };
GrindLoot_Pickpocket = { [16882]=1, [16883]=70, [16884]=175, [16885]=250, [29569]=300, [4632]=1, [4633]=25, [4634]=70, [4636]=125, [4637]=175, [4638]=225, [5758]=225, [5759]=225, [5760]=225, [31952]=325 }

GrindLoot_RarityLevels = { [1]="|cff9d9d9dNone|r", [2]="|cff1eff00Uncommon|r", [3]="|cff0070ddRare|r", [4]="|cffa335eeEpic|r" };
GrindLoot_RarityLevelsTooltips = { [1]="Do not loot based on rarity", [2]="Loot |cff1eff00Uncommon|r or better", [3]="Loot |cff0070ddRare|r or better", [4]="I wantz |cffa335eeEpics|r" };

GrindLoot_ClothLevels = { [0]="|cff9d9d9dNone|r", [1]="Linen", [14]="Wool", [29]="Silk", [39]="Mageweave", [49]="Runecloth", [59]="Netherweave", [69]="Frostweave" };
GrindLoot_Cloth = { [21845]=70, [24272]=70, [24271]=70, [21842]=66, [2996]=10, [4339]=45, [21840]=60, [14048]=55, [4305]=35, [21844]=70, [2997]=25, [2320]=5, [14256]=50, [2321]=20, [8343]=40, [14227]=50, [2589]=5, [4338]=40, [14342]=55, [21877]=60, [21881]=60, [14341]=50, [14047]=50, [10285]=40, [4306]=30, [4291]=30, [3182]=20, [4337]=35, [2592]=15 };

GrindLoot_lootedtrash = {};
haveTrash = false;


function GrindLootConfigFrame_OnLoad()
	SlashCmdList["GLOOT"] = GrindLootConfigFrame_OnOff;
	SLASH_GLOOT1 = "/grindloot";
	SLASH_GLOOT2 = "/gloot"; -- A shortcut or alias
end

function GrindLootConfigFrame_OnOff()
	GrindLootOptionsControlsPanel:Show();
end

function GrindLootBoxFrame_OnShow()
	if(GrindLootVars["useGrindLoot"]=="1") then
		SetCVar( "autoLootDefault",0);
	end
end

function GrindLootBoxFrame_OnLoad()
	this:RegisterEvent("LOOT_OPENED");
	this:RegisterEvent("LOOT_CLOSED");
	this:RegisterEvent("VARIABLES_LOADED");
	GrindLoot_lootedtrash = {};
end

local function GetLootId( slot )
	local itemId = 0
	local link = GetLootSlotLink( slot )

	if link then
		local _, _, idCode = string.find(link, "|Hitem:(%d+):(%d+):(%d+):")
		itemId = tonumber( idCode or 0 )
	end

	return itemId
end

local function GetLinkId( link )
	local itemId = 0
	if link then
		local _, _, idCode = string.find(link, "|Hitem:(%d+):(%d+):(%d+):")
		itemId = tonumber( idCode or 0 )
	end

	return itemId
end


function Gchattext(txt)
	if( DEFAULT_CHAT_FRAME ) then
		DEFAULT_CHAT_FRAME:AddMessage( "|cff00e0ff"..txt )
	end
end

function GrindLoot_OnEvent(event,arg1,arg2,arg3,arg4)
	if (event == "VARIABLES_LOADED") then
		if(GrindLootVars["minRarity"]==nil) then GrindLootVars["minRarity"]=2; end
		if(GrindLootVars["clothLevel"]==nil) then GrindLootVars["clothLevel"]=14; end
		if(GrindLootVars["skinningLoot"]==nil) then GrindLootVars["skinningLoot"]="0"; end
		if(GrindLootVars["miningLoot"]==nil) then GrindLootVars["miningLoot"]="1"; end
		if(GrindLootVars["fishingMode1"]==nil) then GrindLootVars["fishingMode1"]="0"; end
		if(GrindLootVars["fishingMode2"]==nil) then GrindLootVars["fishingMode2"]="0"; end
		if(GrindLootVars["useGrindLoot"]==nil) then GrindLootVars["useGrindLoot"]="1"; end
		Gchattext("GrindLoot v5 Loaded!");
	end

	if (( event == "LOOT_OPENED" ) and (GrindLootVars["useGrindLoot"]=="1")) then
		if (GrindLoot_lootedtrash) and (haveTrash) then
			for b = 0,4 do
				if(GetBagName(b))then
					local ns=GetContainerNumSlots(b);
					for s = 0,ns do
						local blink = GetContainerItemLink(b,s);
						if(blink)then
							lid = GetLinkId(blink);
							if GrindLoot_lootedtrash[lid]==true then
								Gchattext( "deleting "..lid);
								PickupContainerItem(b,s);
								DeleteCursorItem();
								GrindLoot_lootedtrash[lid]=false;
							end
						end
					end
				end
			end
		end
		LootIt();
	end	
end

function LootIt()
	--print("---LOOTING---");

	if(GrindLootVars["useGrindLoot"]~="1") then return; end
	
	local inbag={};
	
	for b = 0,4 do
		if(GetBagName(b))then
			local ns=GetContainerNumSlots(b);
			for s = 0,ns do
				local blink = GetContainerItemLink(b,s);
				if(blink)then
					local lid = GetLinkId(blink);
					if(GrindLoot_lootedtrash[lid]~=true) then 
						inbag[lid]=1;
					end
				end
			end
		end
	end

	local cnt = GetNumLootItems();
	if cnt == 0 then
		Gchattext( "Empty loot" )
		CloseLoot()
		return;
	end
	
	local canclose = false;
	GrindLoot_lootedtrash = {};
	haveTrash = false;
	
	
	for slotnum = 1, cnt do
		local canloot = false;
		local texture, itemName, quantity, quality = GetLootSlotInfo(slotnum)
		local itemID = GetLootId( slotnum )
		local itemName2, itemLink, itemRarity, itemLevel, itemMinLevel, itemType, itemSubType, itemStackCount, itemEquipLoc = GetItemInfo(itemID)
	     
		if(inbag[itemID])then
			canloot = true;
		end;
	        
		if(itemType=="Quest")then
			canloot = true;
		end
	
		if(itemType=="Key") then
			canloot = true;
		end

		if LootSlotIsCoin(slotnum) then
			canloot = true;
		end
		
		if (not canloot) and (GrindLootVars["clothLevel"]>0) and (GrindLoot_Cloth[itemID]) and (itemLevel>=GrindLootVars["clothLevel"]) then
			canloot = true;
		end

		if (not canloot) and (GrindLootVars["minRarity"]>1) and (itemRarity>=GrindLootVars["minRarity"]) then
			canloot = true;
		end

		if GrindLoot_MetalStone[itemID] then
			canloot = true;
		end

		if GrindLoot_Enchanting[itemID] then
			canloot = true;
		end

		if GrindLoot_Pickpocket[itemID] then
			canloot = true;
		end
		
		if GrindLoot_Leather[itemID] then
			canloot = true;
		end

		if GrindLoot_Herbs[itemID] then
			canloot = true;
		end
		
		if (not canloot) and (GrindLootVars["skinningLoot"]=="1") then
			canloot = true;
			GrindLoot_lootedtrash[itemID]=true;
			haveTrash = true;
		end
		
		if (GrindLootVars["miningLoot"]=="1") and stones[itemID] then
			GrindLoot_lootedtrash[itemID]=true;
		end
		
		if IsFishingLoot() then
			if (GrindLootVars["fishingMode1"]=="1") and (itemRarity>0) then
				canclose = true;
				canloot = true;
			end
			if (GrindLootVars["fishingMode2"]=="1") and (itemLevel>=70) then
				canloot = true;
			end
		end
				
		if(canloot)then 
			LootSlot(slotnum); 
		end
	end
	
	inbag={};

	if canclose then
		CloseLoot();
	end
end

function GrindLoot_RarityLevelDropDown_OnEvent (self, event, ...)
	if ( event == "VARIABLES_LOADED" ) then
		self.value = 2;
		if (GrindLootVars) then 
			if (GrindLootVars["minRarity"]) then 
				self.value=GrindLootVars["minRarity"];
			else
				GrindLootVars["minRarity"]=2;
			end
		else
			GrindLootVars = {};
		end
		self.tooltip = GrindLoot_RarityLevels[self.value];

		UIDropDownMenu_SetWidth(self, 90);
		UIDropDownMenu_Initialize(self, GrindLoot_RarityLevelDropDown_Initialize);
		UIDropDownMenu_SetSelectedValue(self, self.value);

		self.SetValue = 
			function (self, value)
				self.value = value;
				UIDropDownMenu_SetSelectedValue(self, value);
				self.tooltip = GrindLoot_RarityLevelsTooltips[value];
			end
		self.GetValue =
			function (self)
				return UIDropDownMenu_GetSelectedValue(self);
			end
		self.RefreshValue =
			function (self)
				UIDropDownMenu_Initialize(self, GrindLoot_RarityLevelDropDown_Initialize);
				UIDropDownMenu_SetSelectedValue(self, self.value);
			end
		
		self:UnregisterEvent(event);
	end
end

function GrindLoot_ClothLevelDropDown_OnEvent (self, event, ...)
	if ( event == "VARIABLES_LOADED" ) then
		self.value = 14;
		if (GrindLootVars) then 
			if (GrindLootVars["clothLevel"]) then 
				self.value=GrindLootVars["clothLevel"];
			else
				GrindLootVars["clothLevel"]=14;
			end
		else
			GrindLootVars = {};
		end
		self.tooltip = GrindLoot_ClothLevels[self.value];

		UIDropDownMenu_SetWidth(self, 90);
		UIDropDownMenu_Initialize(self, GrindLoot_ClothLevelDropDown_Initialize);
		UIDropDownMenu_SetSelectedValue(self, self.value);

		self.SetValue = 
			function (self, value)
				self.value = value;
				UIDropDownMenu_SetSelectedValue(self, value);
				self.tooltip = GrindLoot_ClothLevels[value];
			end
		self.GetValue =
			function (self)
				return UIDropDownMenu_GetSelectedValue(self);
			end
		self.RefreshValue =
			function (self)
				UIDropDownMenu_Initialize(self, GrindLoot_ClothLevelDropDown_Initialize);
				UIDropDownMenu_SetSelectedValue(self, self.value);
			end
		
		self:UnregisterEvent(event);
	end
end


function GrindLoot_RarityLevelDropDown_OnClick(self)
	GrindLootOptionsControlsPanelRarityLevelDropDown:SetValue(self.value);
	GrindLootVars["minRarity"]=self.value;
end

function GrindLoot_ClothLevelDropDown_OnClick(self)
	GrindLootOptionsControlsPanelClothLevelDropDown:SetValue(self.value);
	GrindLootVars["clothLevel"]=self.value;
end

function GrindLoot_RarityLevelDropDown_Initialize()
	local selectedValue = GrindLootVars["minRarity"];
	local info = UIDropDownMenu_CreateInfo();

	info.text = GrindLoot_RarityLevels[1];
	info.func = GrindLoot_RarityLevelDropDown_OnClick;
	info.value = 1;
	if ( info.value == selectedValue ) then
		info.checked = 1;
	else
		info.checked = nil;
	end
	info.tooltipTitle = GrindLoot_RarityLevelsTooltips[1];
	info.tooltipText = "";
	UIDropDownMenu_AddButton(info);

	info.text = GrindLoot_RarityLevels[2];
	info.func = GrindLoot_RarityLevelDropDown_OnClick;
	info.value = 2;
	if ( info.value == selectedValue ) then
		info.checked = 1;
	else
		info.checked = nil;
	end
	info.tooltipTitle = GrindLoot_RarityLevelsTooltips[2];
	info.tooltipText = "";
	UIDropDownMenu_AddButton(info);

	info.text = GrindLoot_RarityLevels[3];
	info.func = GrindLoot_RarityLevelDropDown_OnClick;
	info.value = 3;
	if ( info.value == selectedValue ) then
		info.checked = 1;
	else
		info.checked = nil;
	end
	info.tooltipTitle = GrindLoot_RarityLevelsTooltips[3];
	info.tooltipText = "";
	UIDropDownMenu_AddButton(info);

	info.text = GrindLoot_RarityLevels[4];
	info.func = GrindLoot_RarityLevelDropDown_OnClick;
	info.value = 4;
	if ( info.value == selectedValue ) then
		info.checked = 1;
	else
		info.checked = nil;
	end
	info.tooltipTitle = GrindLoot_RarityLevelsTooltips[4];
	info.tooltipText = "";
	UIDropDownMenu_AddButton(info);
end

function GrindLoot_ClothLevelDropDown_Initialize()
	local selectedValue = GrindLootVars["clothLevel"];
	local info = UIDropDownMenu_CreateInfo();

	info.text = GrindLoot_ClothLevels[0];
	info.func = GrindLoot_ClothLevelDropDown_OnClick;
	info.value = 0;
	if ( info.value == selectedValue ) then
		info.checked = 1;
	else
		info.checked = nil;
	end
	info.tooltipTitle = GrindLoot_ClothLevels[0];
	info.tooltipText = "";
	UIDropDownMenu_AddButton(info);

	info.text = GrindLoot_ClothLevels[1];
	info.func = GrindLoot_ClothLevelDropDown_OnClick;
	info.value = 1;
	if ( info.value == selectedValue ) then
		info.checked = 1;
	else
		info.checked = nil;
	end
	info.tooltipTitle = GrindLoot_ClothLevels[1];
	info.tooltipText = "";
	UIDropDownMenu_AddButton(info);

	info.text = GrindLoot_ClothLevels[14];
	info.func = GrindLoot_ClothLevelDropDown_OnClick;
	info.value = 14;
	if ( info.value == selectedValue ) then
		info.checked = 1;
	else
		info.checked = nil;
	end
	info.tooltipTitle = GrindLoot_ClothLevels[14];
	info.tooltipText = "";
	UIDropDownMenu_AddButton(info);

	info.text = GrindLoot_ClothLevels[29];
	info.func = GrindLoot_ClothLevelDropDown_OnClick;
	info.value = 29;
	if ( info.value == selectedValue ) then
		info.checked = 1;
	else
		info.checked = nil;
	end
	info.tooltipTitle = GrindLoot_ClothLevels[29];
	info.tooltipText = "";
	UIDropDownMenu_AddButton(info);

	info.text = GrindLoot_ClothLevels[39];
	info.func = GrindLoot_ClothLevelDropDown_OnClick;
	info.value = 39;
	if ( info.value == selectedValue ) then
		info.checked = 1;
	else
		info.checked = nil;
	end
	info.tooltipTitle = GrindLoot_ClothLevels[39];
	info.tooltipText = "";
	UIDropDownMenu_AddButton(info);

	info.text = GrindLoot_ClothLevels[49];
	info.func = GrindLoot_ClothLevelDropDown_OnClick;
	info.value = 49;
	if ( info.value == selectedValue ) then
		info.checked = 1;
	else
		info.checked = nil;
	end
	info.tooltipTitle = GrindLoot_ClothLevels[49];
	info.tooltipText = "";
	UIDropDownMenu_AddButton(info);

	info.text = GrindLoot_ClothLevels[59];
	info.func = GrindLoot_ClothLevelDropDown_OnClick;
	info.value = 59;
	if ( info.value == selectedValue ) then
		info.checked = 1;
	else
		info.checked = nil;
	end
	info.tooltipTitle = GrindLoot_ClothLevels[59];
	info.tooltipText = "";
	UIDropDownMenu_AddButton(info);

	info.text = GrindLoot_ClothLevels[69];
	info.func = GrindLoot_ClothLevelDropDown_OnClick;
	info.value = 69;
	if ( info.value == selectedValue ) then
		info.checked = 1;
	else
		info.checked = nil;
	end
	info.tooltipTitle = GrindLoot_ClothLevels[69];
	info.tooltipText = "";
	UIDropDownMenu_AddButton(info);

end

function GrindLoot_EnableDisable_Update(value)
	GrindLootVars["useGrindLoot"]=value;
	if (GrindLootVars["useGrindLoot"]=="1") then 
		Gchattext("GrindLoot Enabled");
	else 
		Gchattext("GrindLoot Disabled"); 
	end
end

function GrindLoot_MiningMode_Update(value)
	GrindLootVars["miningLoot"]=value;
end

function GrindLoot_SkinningMode_Update(value)
	GrindLootVars["skinningLoot"]=value;
end

function GrindLoot_FishingModeAlpha_Update(value)
	GrindLootVars["fishingMode1"]=value;
	if (value == "1") then
		GrindLootVars["fishingMode2"]=0;
		GrindLootOptionsControlsPanelFishingModeBeta:SetChecked(false);
	end
end

function GrindLoot_FishingModeBeta_Update(value)
	GrindLootVars["fishingMode2"]=value;
	if (value == "1") then
		GrindLootVars["fishingMode1"]=0;
		GrindLootOptionsControlsPanelFishingModeAlpha:SetChecked(false);
	end
end

function Get_useGrindLoot()
	if (GrindLootVars) then
		if (GrindLootVars["useGrindLoot"]) then 
			return GrindLootVars["useGrindLoot"];
		else
			return 1;
		end
	else
		return 1;
	end
end

function Get_miningLoot()
	if (GrindLootVars) then
		if (GrindLootVars["miningLoot"]) then 
			return GrindLootVars["miningLoot"];
		else
			return 1;
		end
	else
		return 1;
	end
end

function Get_skinningLoot()
	if (GrindLootVars) then
		if (GrindLootVars["skinningLoot"]) then 
			return GrindLootVars["skinningLoot"];
		else
			return 0;
		end
	else
		return 0;
	end
end

function Get_fishingMode1()
	if (GrindLootVars) then
		if (GrindLootVars["fishingMode1"]) then 
			return GrindLootVars["fishingMode1"];
		else
			return 1;
		end
	else
		return 1;
	end
end

function Get_fishingMode2()
	if (GrindLootVars) then
		if (GrindLootVars["fishingMode2"]) then 
			return GrindLootVars["fishingMode2"];
		else
			return 0;
		end
	else
		return 0;
	end
end

function GrindLootInterfaceOptionsPanel_Cancel (self)
	if (GrindLootOptionsControlsPanelUseGrindLoot.oldValue ~= GrindLootOptionsControlsPanelUseGrindLoot.value) then 
		GrindLootVars["useGrindLoot"]=GrindLootOptionsControlsPanelUseGrindLoot.oldValue;
	end
	if (GrindLootOptionsControlsPanelFastMining.oldValue ~= GrindLootOptionsControlsPanelFastMining.value) then 
		GrindLootVars["miningLoot"]=GrindLootOptionsControlsPanelFastMining.oldValue;
	end
	if (GrindLootOptionsControlsPanelSkinningMode.oldValue ~= GrindLootOptionsControlsPanelSkinningMode.value) then 
		GrindLootVars["skinningLoot"]=GrindLootOptionsControlsPanelSkinningMode.oldValue;
	end
	if (GrindLootOptionsControlsPanelFishingModeAlpha.oldValue ~= GrindLootOptionsControlsPanelFishingModeAlpha.value) then 
		GrindLootVars["fishingMode1"]=GrindLootOptionsControlsPanelFishingModeAlpha.oldValue;
	end
	if (GrindLootOptionsControlsPanelFishingModeBeta.oldValue ~= GrindLootOptionsControlsPanelFishingModeBeta.value) then 
		GrindLootVars["fishingMode2"]=GrindLootOptionsControlsPanelFishingModeBeta.oldValue;
	end
	if (GrindLootOptionsControlsPanelRarityLevelDropDown.oldValue ~= GrindLootOptionsControlsPanelRarityLevelDropDown.value) then 
		GrindLootVars["minRarity"]=GrindLootOptionsControlsPanelRarityLevelDropDown.oldValue;
	end
	if (GrindLootOptionsControlsPanelClothLevelDropDown.oldValue ~= GrindLootOptionsControlsPanelClothLevelDropDown.value) then 
		GrindLootVars["clothLevel"]=GrindLootOptionsControlsPanelClothLevelDropDown.oldValue;
	end
	
end

function GrindLootInterfaceOptionsPanel_Default (self)
	GrindLootVars["useGrindLoot"]="1";
	GrindLootVars["miningLoot"]="1";
	GrindLootVars["skinningLoot"]="0";
	GrindLootVars["fishingMode1"]="1";
	GrindLootVars["fishingMode2"]="0";
	GrindLootVars["minRarity"]=2;
	GrindLootVars["clothLevel"]=14;
	GrindLootInterfaceOptionsPanel_Refresh(self);
end

function GrindLootInterfaceOptionsPanel_Refresh (self)
	GrindLootOptionsControlsPanelUseGrindLoot.oldValue=GrindLootVars["useGrindLoot"];
	GrindLootOptionsControlsPanelFastMining.oldValue=GrindLootVars["miningLoot"];
	GrindLootOptionsControlsPanelSkinningMode.oldValue=GrindLootVars["skinningLoot"];
	GrindLootOptionsControlsPanelFishingModeAlpha.oldValue=GrindLootVars["fishingMode1"];
	GrindLootOptionsControlsPanelFishingModeBeta.oldValue=GrindLootVars["fishingMode2"];
	GrindLootOptionsControlsPanelRarityLevelDropDown.oldValue=GrindLootVars["minRarity"];
	GrindLootOptionsControlsPanelClothLevelDropDown.oldValue=GrindLootVars["clothLevel"];
	GrindLootOptionsControlsPanelUseGrindLoot:SetChecked(GrindLootVars["useGrindLoot"]);
	GrindLootOptionsControlsPanelFastMining:SetChecked(GrindLootVars["miningLoot"]);
	GrindLootOptionsControlsPanelSkinningMode:SetChecked(GrindLootVars["skinningLoot"]);
	GrindLootOptionsControlsPanelFishingModeAlpha:SetChecked(GrindLootVars["fishingMode1"]);
	GrindLootOptionsControlsPanelFishingModeBeta:SetChecked(GrindLootVars["fishingMode2"]);
	GrindLootOptionsControlsPanelRarityLevelDropDown:SetValue(GrindLootVars["minRarity"]);
	GrindLootOptionsControlsPanelRarityLevelDropDown:RefreshValue(GrindLootOptionsControlsPanelRarityLevelDropDown);
	GrindLootOptionsControlsPanelClothLevelDropDown:SetValue(GrindLootVars["clothLevel"]);
	GrindLootOptionsControlsPanelClothLevelDropDown:RefreshValue(GrindLootOptionsControlsPanelClothLevelDropDown);
end
